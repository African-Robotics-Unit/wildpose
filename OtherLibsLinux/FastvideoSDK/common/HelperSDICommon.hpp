/*
Copyright 2012-2021 Fastvideo, Ltd. All rights reserved.

Please refer to the Fastvideo Standard License Agreement (SLA), associated
 with this source code for terms and conditions that govern your use of
 this software. Any use, reproduction, disclosure, or distribution of
 this software and related documentation outside the terms of the SLA is strictly prohibited.

IN NO EVENT SHALL FASTVIDEO BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS, ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF FASTVIDEO HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

FASTVIDEO SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE AND ACCOMPANYING DOCUMENTATION, IF ANY, PROVIDED HEREUNDER IS PROVIDED "AS IS". FASTVIDEO HAS NO OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.
*/
#pragma once

#include "fastvideo_sdk.h"

inline unsigned long GetSDIValueSize(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_YV12_BT709:
		case FAST_SDI_YV12_BT2020:
		case FAST_SDI_YV12_BT601:
		case FAST_SDI_YV12_BT601_FR:

		case FAST_SDI_420_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT2020:
		
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_NV12_BT709:
		case FAST_SDI_NV12_BT2020:
		case FAST_SDI_NV12_BT601:
		case FAST_SDI_NV12_BT601_FR:

		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:

		case FAST_SDI_444_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT2020:
		{
			return sizeof(unsigned char);
		}

		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT601_FR:
		
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return sizeof(unsigned short);
		}
	}

	return 0;
}

inline unsigned long GetSDIWidthAlignValue(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_YV12_BT709:
		case FAST_SDI_YV12_BT2020:
		case FAST_SDI_YV12_BT601:
		case FAST_SDI_YV12_BT601_FR:

		case FAST_SDI_420_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_NV12_BT709:
		case FAST_SDI_NV12_BT2020:
		case FAST_SDI_NV12_BT601:
		case FAST_SDI_NV12_BT601_FR: 

		case FAST_SDI_422_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:
		{
			return 2;
		}
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT2020:
		{
			return 1;
		}

		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT601_FR:

		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		{
			return 2;
		}

		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:
				{
			return 1;
		}

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:
		{
			return 6;
		}

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		{
			return 4;
		}
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return 8;
		}
	}

	return 0;
}

inline unsigned long GetSDIHeightAlignValue(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_YV12_BT709:
		case FAST_SDI_YV12_BT2020:
		case FAST_SDI_YV12_BT601:
		case FAST_SDI_YV12_BT601_FR:

		case FAST_SDI_420_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_NV12_BT709:
		case FAST_SDI_NV12_BT2020:
		case FAST_SDI_NV12_BT601:
		case FAST_SDI_NV12_BT601_FR:
		{
			return 2;
		}

		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:

		case FAST_SDI_422_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_444_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT2020:
		{
			return 1;
		}

		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT601_FR:

		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		{
			return 2;
		}
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		{
			return 1;
		}

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return 1;
		}
	}

	return 0;
}

inline unsigned AlignSDIPitch(unsigned value, bool isHost) {
	if (!isHost)
		return uSnapUp(value, FAST_ALIGNMENT);
	return value;
}

inline bool IsPackedSDI(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return true;
		}
	}
	return false;
}

inline bool IsSDICopy3Format(fastSDIFormat_t _sdiFmt)
{
	return !IsPackedSDI(_sdiFmt);
}


inline fastSurfaceFormat_t GetSDISurfaceFormat(fastSDIFormat_t sdiFmt)
{
	switch (sdiFmt) {
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_P010_BT601_FR:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
			
			return FAST_RGB12;
		default:
			return FAST_RGB8;
	}
	return FAST_RGB8;
}